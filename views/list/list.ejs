<!DOCTYPE html>
<html lang="en">
<%- include('../partials/head.ejs') %>
<body>
    <%- include('../partials/nav.ejs') %>
    <h2>List "<%= body.name %> "</h2>
    <ul class="shopping-list">
        <% body.prodList.forEach(prod => { %>
            <li class="<%= prod.prodChecked ? 'checked' : '' %>">
                <p class="product-name"><%= prod.prodName %></p><p class="quantity"><%= prod.prodQuan %></p>
            </li>
        <% }); %> 
    </ul>
    <button id="delete">Delete</button>
    <span id="id" style="display: none;"><%= body._id %></span>
        

    <%- include('../partials/footer.ejs') %>
</body>
<script>
    document.getElementById('delete').addEventListener('click', e => {
        const id = document.getElementById('id').innerText;
        console.log(id);
        const endpoint = `/mylists/list/${id}`;
        fetch(endpoint, {
            method: 'DELETE'
        }).then(response => {
            response.json().then(data => {
                window.location.href = data.redirect;
            }).catch(err => {
                console.log(err);
            })
        }).catch(err => {
            console.log(err);
        })
    })
</script>
</html>